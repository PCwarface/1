$(function(){$.validator.methods.email=function(b,a){return this.optional(a)||XRegExp("^[\\pL0-9._%+-]+@(?!thecasuallounge)[\\pL0-9.-]+\\.(com|net|org|edu|int|mil|gov|arpa|biz|aero|name|coop|info|pro|museum|en|ru|ua|pl|de|fr|at|ch|no|se|sk|cz|it|uk|dk)$","i").test(b)};$("#formEmailChange").validate({rules:{email:{required:!0,email:!0}},errorContainer:"#emailNotValidError",errorPlacement:function(){return!0},submitHandler:function(){completeEmailChange();return!1}});$("#email").on("keyup",function(){$(".alert").hide()})});
function completeEmailChange(){$("#changeButton").prop("disabled",!0);if(99<$("#email").val().trim().length)$("#emailLengthError").show(),$("#changeButton").prop("disabled",!1);else{var b={email:encodeURIComponent($("#email").val().trim().toLowerCase())};showSpinner();$.post("/mobile/emailChange.action",b,function(a){a.errors?(-1!==a.errors._global.indexOf("accountAlreadyExistError")&&($("#emailAlreadyExistsError").show(),hideSpinner(),$("#changeButton").prop("disabled",!1)),-1!==a.errors._global.indexOf("sameEmailError")&&
($("#sameEmailError").show(),hideSpinner(),$("#changeButton").prop("disabled",!1))):location.href="/MobHome.html"}).fail(function(a){console.error("Internal server error");$("#changeButton").prop("disabled",!1);hideSpinner()})}}function showSpinner(){$(".spinner").show();$("#formEmailChange").hide()}function hideSpinner(){$(".spinner").hide();$("#formEmailChange").show()};